"use strict";const allList=document.querySelector(".js-allBeersList");let allListLi=allList.children;const searchBtn=document.querySelector(".js-searchBtn"),searchInput=document.querySelector(".js-searchInput"),triedList=document.querySelector(".js-triedBeersList");let allBeers=[],triedBeers=[];function searchBeer(){getDataServer("https://api.punkapi.com/v2/beers?beer_name="+searchInput.value.toLowerCase())}function getTried(e){const t=e.currentTarget.firstChild;t.classList.add("allBeersList__article--selectedAll");const s=allBeers.find(e=>e.id===parseInt(t.id)),i=triedBeers.findIndex(e=>e.id===parseInt(t.id));-1===i?triedBeers.push(s):(triedBeers.splice(i,1),t.classList.remove("allBeersList__article--selectedAll")),setLS()}function paintTried(){triedList.innerHTML="";for(const e of triedBeers)paintData(e,triedList,"allBeersList__article--selected");askRate()}function handleClickTried(e){getTried(e),paintTried()}function getClick(){for(let e=0;e<allListLi.length;e++)allListLi[e].addEventListener("click",handleClickTried)}searchBtn.addEventListener("click",e=>{e.preventDefault(),searchBeer()});const triedBeersLS=JSON.parse(localStorage.getItem("triedBeers"));function setLS(){localStorage.setItem("triedBeers",JSON.stringify(triedBeers))}function paintLS(){if(null!==triedBeersLS||triedBeersLS.length>0){triedBeers=triedBeersLS,triedList.innerHTML="";for(const e of triedBeersLS)paintData(e,triedList,"allBeersList__article--selected")}styleWhenLS(),askRate()}function styleWhenLS(){const e=allList.childNodes;for(const t of e){const e=t.firstChild;void 0!==triedBeers.find(t=>t.id===parseInt(e.id))&&e.classList.add("allBeersList__article--selectedAll")}}function askRate(){const e=document.querySelectorAll(".allBeersList__article--selected"),t=Array.prototype.slice.call(e);for(const e of t){const t=triedBeers.find(t=>t.id===parseInt(e.id));if(void 0!==t.rate&&null!==t.rate){const s=document.createElement("p"),i=document.createTextNode(t.rate);s.appendChild(i),e.appendChild(s)}else{console.log(t.rate);const s=document.createElement("input");s.type="text",s.classList.add("js-rateInput");const i=document.createElement("button"),n=document.createTextNode("Rate");i.appendChild(n),i.classList.add("js-rateBtn"),e.appendChild(s),e.appendChild(i),i.addEventListener("click",()=>{const n=s.value;s.classList.add("hidden"),i.classList.add("hidden");const a=document.createElement("p"),r=document.createTextNode(n);a.appendChild(r),e.appendChild(a),t.rate=n,setLS()})}}}function getDataServer(e){fetch(e).then(e=>e.json()).then(e=>{allBeers=e,allList.innerHTML="";for(const e of allBeers)paintData(e,allList,"allBeersList__article");getClick(),styleWhenLS()})}function paintData(e,t,s){const i=document.createElement("li"),n=document.createElement("article");n.classList.add(s),n.setAttribute("id",e.id);const a=document.createElement("img");"null"!==e.image_url?a.src=e.image_url:a.src="https://images.punkapi.com/v2/keg.png",a.alt=e.name,a.style.height="80px",n.appendChild(a);const r=document.createElement("h2"),l=document.createTextNode(e.name);r.classList.add("beers__name"),r.appendChild(l),n.appendChild(r);const d=document.createElement("p"),c=document.createTextNode(e.tagline);d.classList.add("beers__tagline"),d.appendChild(c),n.appendChild(d),i.appendChild(n),t.appendChild(i)}paintLS(),getDataServer("https://api.punkapi.com/v2/beers");